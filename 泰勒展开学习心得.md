**泰勒展开学习心得**

泰勒展开是一种函数的表示方法。

他可以把任何一个任意阶可导的函数用多项式的形式表达。

而多项式无论是做什么运算通常都比那些复杂的函数方便。

他的思想是这样的：

我们要让多项式函数$g(x)=\sum a_ix^i$和原函数$f(x)$ 在$x=0$的位置近似，首先，当然是需要$g(0)=f(0)$ ；多项式中决定 $x=0$的位置的，便是$a_0$ 。

如果我们想要进一步近似，当然不能满足于此；我们希望$g(x)$和$f(x)$这个位置的导数（变化率）也相等。

决定$g(0)$的导数的便是$a_1$ ；我们希望$f'(0) = g'(0)$ ，便有$g'(0)=a_1+\sum a_{i+2}\cdot i\cdot x^i=a_1=f'(0) $

那么我们如果希望 $f^{(n)}(0)=g^{(n)}(0)$ ，则有$g^{(n)}(0) = n!\cdot a_n=f(0)$ ，这时，多项式便为$\sum_{n=0}^{m}f^{(n)}(0)\frac{x^n}{n!}$ ；

如果我们把其推广到任意$x_0$位置开始近似，便得到了看上去很像泰勒展开的式子：
$$
g(x) = \sum_{n=0}^{m}f^{(n)}(x_0)\frac{(x-x_0)^n}{!n}
$$
观察$\cos$函数在$0$处的$0,1,2,3,4,5...$阶展开。

![无标题](C:\Users\A\Documents\无标题.png)

我们发现，随着我们展开的越多，多项式越来越逼近原函数；

那我们想到：

会不会当$m$趋近于无限大时，$f$函数和$g$函数相等？

猜想：
$$
g(x) = \sum_{n=0}^{\infty}f^{(n)}(x_0)\frac{(x-x_0)^n}{!n}
$$
这里不给出严格证明，但是可以稍稍感性地理解：两个函数在$x_0$处的任意阶导数相等，则两个函数等价。

> “为啥一个地方的导数就可以决定整个函数？“

根据导数的定义，我们可知：$f'(x_0)$的意义便是$f(x)$在$x_0$的位置的切线斜率，也就是对$f(x)$发展趋势的预判。但单看这一个地方的导数则太片面了：比如$\cos'(0)=0$ ，在$0$这个位置的切线水平；虽然在趋近于无穷小的范围内，导数是预判准确了的，但实际上接下来的$[0,\frac{\pi}{2}]$的范围内，整个函数处下降趋势。

而$f(x)$的二阶导$f''(x)$则是进一步，对$f'(x)$进行了预判。例如$\cos''(0)=-1$ ，则说明$\cos'(x)$接下来是呈下降趋势的。但是又如何预判下一个拐点呢？$\cos'''(0)=0$ ，说明下降趋势保持稳定；$\cos''''(0)=1$则预判了上升（预判了$\cos'''(x)$的上升趋势，说明$\cos''(x)$接下来的会上升，进而说明$\cos'$的上升）

可见，导数阶数越高，预测地越远。

---

有了泰勒展开，很多函数都好搞了。

比如我们维护若干函数的组合时，就可以只维护十几阶展开，在小范围内就很准确了。

为了进一步说明泰勒展开的用处，我这里举几个函数展开的例子：
$$
\sin(x) = \sum_{n=0}^{\infty}\frac{(-1)^{n+1}}{(2n+1)!}x^{2n+1}
$$

$$
\cos(x) = \sum_{n=0}^{\infty}\frac{(-1)^{n}}{2n!}x^{2n}
$$

$$
\mathrm{e}^x = \sum_{n=0}^{\infty}\frac{1}{n!}x^{n}
$$

>~~有趣的是$x=i$时可以得到欧拉公式233~~

这样一来，小范围内的函数求值就方便了很多。

比如[THUWC2017的第一题](https://loj.ac/problem/2289)：

让你维护动态树上一条路径上所有点的权值和；计算方式是：每个节点有参数f，a，b；

$f=1$，表示节点上有函数$\sin(ax+b)$

$f=2$，表示节点上有函数$e^{ax+b}$

$f=3$，表示节点上有函数$ax+b$

而$a,b,x$的范围都在较小；

计算路径权值和时，便会给出$x$的值，带入路径上所有点的函数中计算权值和。

这里的$a,b$的位置很尴尬啊。如何用方便合并的方式来处理呢？

如果用多项式的方式存储，合并的时候也只是简单的多项式相加。

所以我们只需要稍稍泰勒展开成多项式，存在每个节点上。LCT维护树链的多项式和，就可以解决了（还是挺裸的233。

（代码就不贴了，贴了也没用，反正标程一大堆233